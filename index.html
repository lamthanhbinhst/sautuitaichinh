<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sáu Túi Tài Chính</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #f3f4f6; font-family: sans-serif; }
        .jar-card { transition: transform 0.2s; }
        .jar-card:active { transform: scale(0.98); }
    </style>
</head>
<body>
    <div class="max-w-md mx-auto p-4 pb-20">
        <header class="text-center mb-6">
            <h1 class="text-2xl font-bold text-blue-600">6 TÚI TÀI CHÍNH</h1>
            <p class="text-gray-500 text-sm">Quản lý chi tiêu thông minh</p>
        </header>

        <div class="bg-white p-4 rounded-xl shadow-md mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2">Nhập tổng thu nhập:</label>
            <input type="number" id="income" placeholder="Ví dụ: 10000000" 
                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-lg">
            <button onclick="calculateJars()" 
                class="w-full mt-3 bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition">
                Chia Tiền Ngay
            </button>
        </div>

        <div id="result" class="grid grid-cols-1 gap-4">
            </div>
    </div>

    <script>
        const jarsData = [
            { name: "Thiết yếu (NEC)", percent: 55, color: "bg-blue-100", textColor: "text-blue-700", desc: "Ăn uống, tiền nhà, xăng xe..." },
            { name: "Tiết kiệm (LTS)", percent: 10, color: "bg-green-100", textColor: "text-green-700", desc: "Mua nhà, mua xe, dự phòng..." },
            { name: "Giáo dục (EDU)", percent: 10, color: "bg-yellow-100", textColor: "text-yellow-700", desc: "Học tập, mua sách, khóa học..." },
            { name: "Hưởng thụ (PLAY)", percent: 10, color: "bg-pink-100", textColor: "text-pink-700", desc: "Du lịch, xem phim, ăn hàng..." },
            { name: "Đầu tư (FFA)", percent: 10, color: "bg-purple-100", textColor: "text-purple-700", desc: "Chứng khoán, kinh doanh..." },
            { name: "Từ thiện (GIVE)", percent: 5, color: "bg-orange-100", textColor: "text-orange-700", desc: "Quà tặng, giúp đỡ người khác..." }
        ];

        function calculateJars() {
            const income = document.getElementById('income').value;
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '';

            if (!income || income <= 0) {
                alert('Vui lòng nhập số tiền hợp lệ!');
                return;
            }

            jarsData.forEach(jar => {
                const amount = (income * jar.percent / 100).toLocaleString('vi-VN');
                const card = `
                    <div class="${jar.color} p-4 rounded-xl shadow-sm border border-white jar-card">
                        <div class="flex justify-between items-center mb-1">
                            <span class="font-bold ${jar.textColor}">${jar.name} (${jar.percent}%)</span>
                            <span class="text-xl font-black ${jar.textColor}">${amount}đ</span>
                        </div>
                        <p class="text-xs text-gray-600">${jar.desc}</p>
                    </div>
                `;
                resultDiv.innerHTML += card;
            });
        }

        // Đăng ký Service Worker để chạy Offline và cài đặt PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                const blob = new Blob([`
                    const CACHE_NAME = 'jar-v1';
                    self.addEventListener('install', e => {
                        e.waitUntil(caches.open(CACHE_NAME).then(cache => cache.addAll(['./'])));
                    });
                    self.addEventListener('fetch', e => {
                        e.respondWith(caches.match(e.request).then(res => res || fetch(e.request)));
                    });
                `], { type: 'text/javascript' });
                const swUrl = URL.createObjectURL(blob);
                navigator.serviceWorker.register(swUrl).catch(console.error);
            });
        }
    </script>
</body>
</html>
